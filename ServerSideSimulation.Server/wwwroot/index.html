<html>
<body>
    <script>
        const width = 800;
        const height = 800;
        const pixelSize = 4;

        const canvas = document.createElement('canvas');
        canvas.width = width;
        canvas.height = height;
        document.body.appendChild(canvas);

        const ctx = canvas.getContext('2d');
        const imageData = ctx.createImageData(width, height);
        const buffer = new Uint8Array(width * height * pixelSize);

        const socket = new WebSocket('ws://localhost:8080/ws');
        socket.binaryType = 'arraybuffer';

        socket.onmessage = function (event) {
            const data = new Uint8Array(event.data);

            if (data.length === buffer.length) {
                buffer.set(data);
                imageData.data.set(buffer);
                ctx.putImageData(imageData, 0, 0);
            } else {
                console.warn("Mismatching buffer size. Skipping frame.");
                console.warn("Exptected: " + buffer.length + ", Actual: " + data.length);
            }
        };

        socket.onopen = function () {
            console.log('Connected to the server.');
        };

        socket.onerror = function (error) {
            console.error('WebSocket Error: ', error);
        };

        socket.onclose = function () {
            console.log('WebSocket connection closed.');
        };
    </script>
</body>
</html>